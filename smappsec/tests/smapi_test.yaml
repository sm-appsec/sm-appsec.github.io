suite: "smapi tests"
templates:
  - templates/smapi-deployment.yaml

tests:
  - it: "should contain a container named smapi"
    asserts:
      - hasContainer:
          name: smapi

  - it: "should set the correct image"
    asserts:
      - isEqual:
          path: "spec.template.spec.containers[0].image"
          value: "ghcr.io/sm-appsec/smapi:0.1"

  - it: "should set environment variables"
    asserts:
      - isKind:
          of: "Deployment"
      - isEqual:
          path: "spec.template.spec.containers[0].env[0].name"
          value: "DATABASE_URL"
